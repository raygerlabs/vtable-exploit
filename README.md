# VTable Exploit

This repository contains a short example to replace entries in the virtual method table during C++ runtime.

It's only for educational purposes.

### Prerequisites

- Python3
- Cmake
- Conan
- Ninja
- Your favorite C++ compiler :)

### Install system dependencies

#### Linux:

```
$ sudo apt update
$ sudo apt install -y build-essential python3 python3-pip
$ pip install --user conan cmake ninja
$ source ~/.profile
$ conan --version
$ ninja --version
$ cmake --version
```

#### Windows

https://www.python.org/downloads/
https://visualstudio.microsoft.com/

Open python console prompt
```
$ pip install --user conan cmake ninja
```

### Build the project

Use CMakePresets and Conan respectively.

NOTE: For windows, use developer command prompt for all times! This is very important!

First install project dependencies from public Conan center:
```
$ conan install . --install-folder /path/to/the/build -s build_type=Debug -pr:b default --build missing
$ conan install . --install-folder /path/to/the/build -s build_type=Release -pr:b default --build missing
```
Then you can execute the build with:

```Visual Studio
$ cmake --workflow --preset msvc-debug
$ cmake --workflow --preset msvc-release
```

```clang
$ cmake --workflow --preset clang-debug
$ cmake --workflow --preset clang-release
```

```gcc
$ cmake --workflow --preset gcc-debug
$ cmake --workflow --preset gcc-release
```

Here is further options for your convenience. The first method is the most convenient btw.

```
# 1. Install project dependencies from the Conan remote:


# 2.a For a single-configuration generator:
$ cmake -S . -B /path/to/the/build -DCMAKE_BUILD_TYPE=Release
$ cmake --build /path/to/the/build
$ cmake --install /path/to/the/build --prefix /path/to/the/install

# 2.b For a multi-configuration generator:
$ cmake -S . -B /path/to/the/build
$ cmake --build /path/to/the/build --config Release
$ cmake --install /path/to/the/build --config Release --prefix /path/to/wherever

# 3. Run unit tests
$ ctest --test-dir /path/to/the/build -VV -C Release

# 4. Package
$ cmake --build /path/to/the/build --config Release --target package

# Alternatively, you can call cpack
$ cd /path/to/the/build
$ cpack
```

# Known stuff

- If you build the project with address sanitizer, the sanitizer tool will recognize that virtual method table is exploited.
